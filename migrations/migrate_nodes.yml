id: migrate_nodes_test
label: 'migrate_nodes'
source:
  constants:
    pseudo_field_district_tid: 8
    product_term_tid: 9
    slash_character: '/'

  plugin: url
  data_fetcher_plugin: file
  data_parser_plugin: json

  urls:
    - modules/custom/migrate_json/data/import.json

  item_selector: /nodes

  fields:
    - name: title
      label: 'title'
      selector: node/title
    - name: body
      label: 'body'
      selector: node/body
    - name: main_section
      label: 'main_section'
      selector: node/main_section
    - name: my_path
      label: 'my_path'
      selector: node/my_path

  ids:
    title:
      type: string

process:
  title: title
  body: body
  field_section:
    - plugin: entity_generate
      source: main_section
      entity_type: taxonomy_term
      ignore_case: true
      value_key: name
      bundle_key: vid
      bundle: office_name
      values:
        name: main_section
        parent: 'constants/pseudo_field_district_tid'
        field_product: 'constants/product_term_tid'

  path/alias:
    plugin: concat
    delimiter:
    source:
      - constants/slash_character
      - my_path

  path/pathauto:
    plugin: default_value
    default_value: 0

destination:
  plugin: 'entity:node'
  default_bundle: entry
  overwrite_properties:
    -  field_section

migration_dependencies:
  optional: []
